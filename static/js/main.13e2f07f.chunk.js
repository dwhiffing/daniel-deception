(this.webpackJsonpdeception=this.webpackJsonpdeception||[]).push([[0],{1158:function(e,t){},1172:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),i=n.n(c),o=n(10),l=n(2),s=n(13),u=n(1199),m=n(1202),d=function(e){var t=e.variant,n=e.flex,a=void 0===n?1:n,c=e.children,i=e.style,o=void 0===i?{}:i,u=Object(l.a)(e,["variant","flex","children","style"]),d={display:"flex",flex:a};return/column/.test(t)&&(d.flexDirection="column"),/justify-between/.test(t)&&(d.justifyContent="space-between"),/align-center/.test(t)?d.alignItems="center":/justify-center/.test(t)?d.justifyContent="center":/center/.test(t)&&(d.justifyContent="center",d.alignItems="center"),r.a.createElement(m.a,Object.assign({style:Object(s.a)({},d,{},o)},u),c)},f=n(1203);function p(e){var t=e.room,n=e.players,a=e.phaseIndex,c=e.selectedMeans,i=e.crime,o=e.selectedClue,l=n.find((function(e){return e.id===t.sessionId}))||{},u=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.send(Object(s.a)({action:e},n))};return r.a.createElement(d,{flex:0,variant:"center",zIndex:100,style:{borderTop:"1px solid gray",backgroundColor:"white",padding:10,minHeight:50,position:"fixed",bottom:0,left:0,right:0}},l.isAdmin&&-1===a&&r.a.createElement(b,{disabled:0===n.filter((function(e){return 1===e.role})).length,onClick:function(){return u("deal")}},"Deal"),0===a&&(2===l.role?r.a.createElement(d,{variant:"column center"},(!c||!o)&&r.a.createElement("p",null,"Select one of your Red Means cards and Blue Clue cards to plan the murder."),c&&o&&r.a.createElement("p",null,"You will kill the victim using ",c," and leave behind"," ",o," as evidence."),r.a.createElement(b,{disabled:!c||!o,onClick:function(){u("murder",{means:c,clue:o})}},"Commit Murder")):r.a.createElement("p",null,"The murder is currently happening")),1===a&&(1===l.role?r.a.createElement("p",null,"Mark the crime scene based on the means ",i[1]," and the clue"," ",i[0]):r.a.createElement("p",null,"The Forensic Scientist is investigating")),2===a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Discuss the clues given by Forensics to determine the murderer, and via which means (Red) and key evidence (Blue). You only get one chance to accuse!"),l.hasBadge&&r.a.createElement(d,{variant:"column center"},r.a.createElement(b,{disabled:!c||!o,onClick:function(){u("accuse",{means:c,clue:o})}},"Accuse"))))}var b=function(e){var t=e.variant,n=void 0===t?"contained":t,a=Object(l.a)(e,["variant"]);return r.a.createElement(f.a,Object.assign({variant:n},a,{style:{margin:8}}))},v=function(e){var t=e.children,n=e.selected,a=e.backgroundColor,c=e.onClick,i=e.style,o=void 0===i?{}:i;return r.a.createElement(d,{variant:"center",onClick:c,style:Object(s.a)({},o,{margin:2,padding:10,borderRadius:8,boxSizing:"borderBox",border:n?"4px solid black":null,backgroundColor:a})},r.a.createElement(u.a,{style:{fontWeight:"bold",textAlign:"center",color:"white"}},t))},E=function(e){var t=e.showSetScientistButton,n=e.sendAction,a=e.player,c=e.currentPlayer,i=e.phaseIndex,o=e.selectedClue,l=e.setSelectedClue,m=e.selectedMeans,p=e.setSelectedMeans,b=e.style,E=void 0===b?{}:b,y=a.id,g=a.clues,j=a.role,x=a.means,O=a.isClient,k=a.index,C=a.name,w=0===i&&2===c.role&&a.id===c.id||2===i&&y!==c.id&&1!==c.role,S=w?"FF":"55";return y?r.a.createElement(d,{variant:"column",style:Object(s.a)({border:"5px solid ".concat(h[k]),margin:10,padding:10},E)},r.a.createElement(u.a,{variant:O?"h5":"body1"},O?"You (".concat(C||y,")"):C||y),r.a.createElement(d,{variant:"justify-between"},x.map((function(e,t){return r.a.createElement(v,{backgroundColor:"#D33830".concat(S),selected:m===e,key:"means-".concat(t),onClick:function(){return w&&p(e)}},e)}))),r.a.createElement(d,{variant:"justify-between"},g.map((function(e,t){return r.a.createElement(v,{backgroundColor:"#0071AA".concat(S),key:"clue-".concat(t),selected:o===e,onClick:function(){return w&&l(e)}},e)}))),t&&1!==j&&r.a.createElement(f.a,{variant:"contained",onClick:function(){return n("setScientist",{playerId:a.id})}},"Assign Forensic Scientist")):null},h=["#0071AA","#ECE4B7","#E8C340","#D33830","#A06033","#EA9438","#E27C81","#7FC12E","#525252","#AA5BAF"];function y(e){var t=e.players,n=e.crime,c=e.scene,i=e.room,l=e.phaseIndex,m=e.phaseTimer,f=Object(a.useState)(),b=Object(o.a)(f,2),v=b[0],E=b[1],h=Object(a.useState)(),y=Object(o.a)(h,2),O=y[0],k=y[1],C=t.find((function(e){return e.id===i.sessionId}))||{},w=t.find((function(e){return 1===e.role})),S=w?w.name:"none";t.find((function(e){return 2===e.role}));Object(a.useEffect)((function(){E(),k()}),[l]),w===C&&(S="You (".concat(w.name,")"));var I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.send(Object(s.a)({action:e},t))};return r.a.createElement(d,{variant:"column",style:{paddingTop:50,paddingBottom:200}},r.a.createElement(g,{phaseIndex:l,phaseTimer:m}),r.a.createElement(d,{variant:"column"},(1===l||2===l)&&r.a.createElement(j,{player:C,scene:c,sendAction:I}),r.a.createElement(u.a,{align:"center"},"Forensic Scientist: ",S),(2===l||-1===l||0===l&&2===C.role||1===l&&1!==C.role)&&r.a.createElement(x,{showSetScientistButton:C.isAdmin&&-1===l,sendAction:I,currentPlayer:C,selectedMeans:v,selectedClue:O,phaseIndex:l,setSelectedMeans:function(e){return E((function(t){return t===e?null:e}))},setSelectedClue:function(e){return k((function(t){return t===e?null:e}))},players:t.map((function(e,t){return Object(s.a)({},e,{index:t,isClient:e.id===i.sessionId})})).filter((function(e){return 1!==e.role}))})),r.a.createElement(p,{room:i,players:t,crime:n,phaseIndex:l,selectedMeans:v,selectedClue:O}))}var g=function(e){var t=e.phaseIndex,n=e.phaseTimer;return r.a.createElement(d,{flex:0,variant:"row justify-between",style:{padding:10,borderBottom:"1px solid gray",position:"fixed",top:0,left:0,right:0,backgroundColor:"white"}},r.a.createElement("span",{style:{minWidth:50}},"Deception"),r.a.createElement("span",{style:{minWidth:50}},O[t+1]),r.a.createElement("span",{style:{minWidth:50}},n))},j=function(e){return r.a.createElement(d,{variant:"column justify-between",style:{flexWrap:"wrap"}},e.scene.filter((function(t){return 1===e.player.role||t.markedValueIndex>-1})).map((function(t,n){return r.a.createElement(d,{variant:"column align-center",key:"scene-".concat(n),style:{margin:8}},r.a.createElement(u.a,{variant:"h5",align:"center"},t.type),r.a.createElement(d,{style:{width:"100%",flexWrap:"wrap"}},t.values.map((function(n,a){return r.a.createElement(d,{variant:"center",key:"scene-".concat(a)},r.a.createElement(v,{backgroundColor:t.markedValueIndex===a?"#D33830":"gray",style:{minWidth:100},onClick:function(){return e.sendAction("markScene",{type:t.type,value:n})}},n))}))))})))},x=function(e){var t=e.players,n=Object(l.a)(e,["players"]);return r.a.createElement(d,{flex:2,variant:"column"},t.map((function(e,t){return r.a.createElement(E,Object.assign({key:"seat-".concat(e.index),player:e},n))})))},O=["PRE-GAME","MURDER PHASE","EVIDENCE PHASE","PRESENTATION PHASE"],k=n(16),C=n.n(k),w=n(29),S=n(1200),I=n(61),A=n.n(I),B=n(62),R=n.n(B),T=function(e,t){localStorage.setItem("name",t),localStorage.setItem(e.id,e.sessionId)},N=function(){var e=Object(w.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=localStorage.getItem(t))){e.next=10;break}return e.prev=2,e.next=5,window.colyseus.reconnect(t,a);case 5:n=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:if(e.t1=n,e.t1){e.next=15;break}return e.next=14,window.colyseus.joinById(t);case 14:e.t1=e.sent;case 15:return n=e.t1,e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();function M(e){var t=e.setRoom,n=Object(a.useState)([]),c=Object(o.a)(n,2),i=c[0],l=c[1],s=Object(a.useState)(localStorage.getItem("name")||A.a.name.firstName()),m=Object(o.a)(s,2),p=m[0],b=m[1],v=Object(a.useRef)(),E=Object(a.useRef)(!1),h=Object(a.useCallback)(function(){var e=Object(w.a)(C.a.mark((function e(n){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=prompt("Room name?")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,window.colyseus.create("deception",{roomName:a});case 5:r=e.sent,T(r,n),r.send({action:"setName",name:n}),r.send({action:"sit"}),t(r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]),y=Object(a.useCallback)(function(){var e=Object(w.a)(C.a.mark((function e(n,a){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(n);case 2:if(r=e.sent){e.next=6;break}return alert("Failed to join room"),e.abrupt("return");case 6:T(r,a),r.send({action:"setName",name:a}),r.send({action:"sit"}),t(r);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[t]),g=Object(a.useCallback)(Object(w.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.colyseus.getAvailableRooms();case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)}))),[]);return Object(a.useEffect)((function(){return g(),v.current=setInterval(g,3e3),function(){return clearInterval(v.current)}}),[g]),Object(a.useEffect)((function(){if(i){var e=i.find((function(e){return localStorage.getItem(e.roomId)}));e&&!E.current&&(E.current=!0,y(e.roomId,p))}}),[i,y,p]),r.a.createElement(d,{variant:"column center",style:{height:"100vh"}},r.a.createElement(S.a,{placeholder:"Enter name",value:p,onChange:function(e){return b(R()(e.target.value,{length:10,omission:""}))},style:{marginBottom:20}}),r.a.createElement(u.a,{variant:"h5"},"Available Tables:"),r.a.createElement(d,{flex:0,variant:"column center",style:{minHeight:200}},0===i.length&&r.a.createElement(F,null),i.map((function(e){return r.a.createElement(D,{key:e.roomId,room:e,onClick:function(){return y(e.roomId,p)}})}))),r.a.createElement(f.a,{variant:"contained",onClick:function(){return h(p)}},"Create room"))}var D=function(e){var t=e.room,n=e.onClick;return r.a.createElement(m.a,null,r.a.createElement(u.a,{style:{cursor:"pointer",textDecoration:"underline"},onClick:n},t.metadata.roomName||t.roomId))},F=function(){return r.a.createElement(u.a,null,"No rooms available")};var P=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)([]),l=Object(o.a)(i,2),s=l[0],u=l[1],m=Object(a.useState)(-1),f=Object(o.a)(m,2),p=f[0],b=f[1],v=Object(a.useState)(2),E=Object(o.a)(v,2),h=E[0],g=E[1],j=Object(a.useState)(-1),x=Object(o.a)(j,2),O=x[0],k=x[1],C=Object(a.useState)([]),w=Object(o.a)(C,2),S=w[0],I=w[1],A=Object(a.useState)([]),B=Object(o.a)(A,2),R=B[0],T=B[1];return Object(a.useEffect)((function(){n&&(n.onLeave((function(){c(null),u([]),b(-1),g(2),I([])})),n.state.onChange=function(e){return e.forEach((function(e){var t=e.field,n=e.value;"players"===t?u(n.toJSON()):"activeScene"===t?I(n.toJSON()):"activeCrime"===t?T(n.toJSON()):"phaseIndex"===t?b(n):"roundsLeft"===t?g(n):"phaseTimer"===t?k(n):"message"===t&&n&&alert(n)}))})}),[n]),console.log({players:s,scene:S,phaseIndex:p,phaseTimer:O,crime:R}),r.a.createElement(d,{variant:"column"},n?r.a.createElement(y,{room:n,players:s,scene:S.slice(0,S.length-h),phaseTimer:O,phaseIndex:p,crime:R}):r.a.createElement(M,{setRoom:c}))},W=n(63);window.colyseus=new W.Client("wss://daniel-deception.herokuapp.com"),i.a.render(r.a.createElement(P,null),document.getElementById("root"))},71:function(e,t,n){e.exports=n(1172)}},[[71,1,2]]]);
//# sourceMappingURL=main.13e2f07f.chunk.js.map